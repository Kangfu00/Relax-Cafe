<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Relax Cafe - Menu Management</title>
<style>
    /* --- Themes (Relax Cafe Style) --- */
    body { font-family: "Prompt", sans-serif; background-color: #d8bc9b; margin: 0; padding: 0; }
    
    /* Navbar */
    .navbar { display: flex; justify-content: center; gap: 70px; padding: 20px 0; font-size: 22px; font-weight: bold; }
    .navbar a { color: #5d5d5d; text-decoration: none; transition: color 0.2s; }
    .navbar .active { color: #7e50c8; border-bottom: 3px solid #7e50c8; padding-bottom: 5px; }
    
    /* Container */
    .content-container { background: #fdfae9; width: 90%; margin: 20px auto 0; border-radius: 6px; padding: 40px; box-sizing: border-box; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); }
    
    h2 { text-align: center; margin-top: 0; font-size: 28px; color: #5d5d5d; }
    
    /* Form Styles */
    .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-top: 20px; }
    .form-group { display: flex; flex-direction: column; }
    label { margin-bottom: 6px; font-weight: 600; color: #5d5d5d; }
    input, select, textarea { padding: 10px; border-radius: 6px; border: none; background: #f1f1e9; font-size: 16px; }
    textarea { resize: vertical; height: 80px; }
    
    .submit-btn { background-color: #69c84c; color: white; padding: 12px 25px; border: none; border-radius: 6px; font-size: 18px; cursor: pointer; margin-top: 25px; display: block; margin-left: auto; }
    .submit-btn:hover { background-color: #58a83e; }

    /* List Styles */
    .list-header { display: grid; grid-template-columns: 60px 80px 1fr 1fr 100px 100px 60px; gap: 15px; padding: 12px 0; text-align: center; font-weight: bold; background-color: #f1f1e9; margin-top: 20px; border-radius: 6px; border-bottom: 2px solid #ccc; }
    
    .list-row { display: grid; grid-template-columns: 60px 80px 1fr 1fr 100px 100px 60px; gap: 15px; padding: 12px 0; text-align: center; background-color: #f1f1e9; margin-top: 10px; border-radius: 6px; align-items: center; }
    
    .menu-img-thumb { width: 60px; height: 60px; object-fit: cover; border-radius: 8px; background: #ccc; }
    .status-active { color: #28a745; font-weight: bold; }
    .status-inactive { color: #dc3545; font-weight: bold; }
    .delete-btn { cursor: pointer; color: #ff0000; font-size: 20px; }

    /* Bottom Menu Tabs */
    .bottom-menu { display: flex; justify-content: center; gap: 40px; margin: 40px 0; }
    .menu-btn { background-color: white; border: none; padding: 18px 40px; border-radius: 45px; font-size: 22px; font-weight: bold; cursor: pointer; box-shadow: 0px 4px 12px rgba(0,0,0,0.15); transition: 0.2s; border: 2px solid transparent; }
    .menu-btn.active { background-color: #f0e6ff; border: 2px solid #7e50c8; color: #7e50c8; box-shadow: 0px 4px 15px rgba(126, 80, 200, 0.4); }
    
    /* Toggle Pages */
    .page-content { display: none; }
    .page-content.active { display: block; }
</style>
</head>
<body>

    <div class="navbar">
        <a href="index.html">Relax Cafe</a>
        <a class="active">Menu</a>
        <a href="Orders.html">Orders</a>
        <a href="Users.html">Users</a>
        <a href="Discount.html">Discount</a>
    </div>
    
    <div class="content-container">

        <!-- 1. ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π -->
        <div id="menu-list-page" class="page-content active">
            <h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h2>
            <div class="list-header">
                <span>ID</span>
                <span>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</span>
                <span style="text-align:left;">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π</span>
                <span>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</span>
                <span>‡∏£‡∏≤‡∏Ñ‡∏≤</span>
                <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</span>
                <span>‡∏•‡∏ö</span>
            </div>
            <div id="menu-list-rows">
                <!-- Data will come here via JS -->
            </div>
        </div>

        <!-- 2. ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π -->
        <div id="add-menu-page" class="page-content">
            <h2>‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏´‡∏°‡πà</h2>
            <form id="add-menu-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π (Menu Name)</label>
                        <input type="text" name="menu_name" required>
                    </div>
                    
                    <div class="form-group">
                        <label>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà (Category)</label>
                        <select name="category_id" required>
                            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà --</option>
                            <option value="1">Coffee</option>
                            <option value="2">Bakery</option>
                            <option value="3">Non-Coffee</option>
                            <option value="4">Food</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>‡∏£‡∏≤‡∏Ñ‡∏≤ (Price)</label>
                        <input type="number" name="price" step="0.01" required>
                    </div>

                    <div class="form-group">
                        <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (Status)</label>
                        <select name="status" required>
                            <option value="available">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢ (Available)</option>
                            <option value="unavailable">‡∏´‡∏°‡∏î (Unavailable)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (Image)</label>
                        <input type="file" name="image_file" accept="image/*">
                    </div>

                    <div class="form-group">
                        <label>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (Description)</label>
                        <textarea name="description"></textarea>
                    </div>
                </div>
                <button type="submit" class="submit-btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏°‡∏ô‡∏π</button>
            </form>
        </div>

    </div>

    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á -->
    <div class="bottom-menu">
        <button class="menu-btn active" id="btn-list" onclick="showPage('menu-list-page', this)">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π</button>
        <button class="menu-btn" id="btn-add" onclick="showPage('add-menu-page', this)">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏´‡∏°‡πà</button>
    </div>

<script>
    // üëáüëáüëá ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå PHP ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡∏Ñ‡∏£‡∏±‡∏ö (‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô Server ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢) üëáüëáüëá
    const API_URL = 'api_menu.php'; 

    // --- 1. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ (Tab Switching) ---
    function showPage(pageId, btn) {
        document.querySelectorAll('.page-content').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
        
        document.getElementById(pageId).classList.add('active');
        if(btn) btn.classList.add('active');

        if(pageId === 'menu-list-page') {
            loadMenus();
        }
    }

    // --- 2. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏ô‡∏π (Fetch GET) ---
    function loadMenus() {
        const listArea = document.getElementById('menu-list-rows');
        listArea.innerHTML = '<p style="text-align:center;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>';

        fetch(API_URL)
            .then(response => response.json())
            .then(data => {
                listArea.innerHTML = '';
                // ... (‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏ä‡πá‡∏Ñ Error ‡πÄ‡∏î‡∏¥‡∏°) ...

                // üëáüëáüëá 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏õ‡∏• ID ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà üëáüëáüëá
                const categoryNames = {
                    1: "Coffee (‡∏Å‡∏≤‡πÅ‡∏ü)",
                    2: "Bakery (‡πÄ‡∏ö‡πÄ‡∏Å‡∏≠‡∏£‡∏µ‡πà)",
                    3: "Non-Coffee (‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ)",
                    4: "Food (‡∏≠‡∏≤‡∏´‡∏≤‡∏£)"
                };

                data.forEach(menu => {
                    const imgTag = menu.image_url 
                        ? `<img src="${menu.image_url}" class="menu-img-thumb">`
                        : `<div class="menu-img-thumb" style="...">No Img</div>`;

                    const statusClass = menu.status === 'available' ? 'status-active' : 'status-inactive';
                    const statusText = menu.status === 'available' ? '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢' : '‡∏´‡∏°‡∏î';

                    // üëáüëáüëá 2. ‡πÅ‡∏õ‡∏•‡∏á ID ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö üëáüëáüëá
                    // ‡∏ñ‡πâ‡∏≤‡∏´‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç ID ‡πÄ‡∏î‡∏¥‡∏°
                    const catName = categoryNames[menu.category_id] || `ID: ${menu.category_id}`;

                    const row = document.createElement('div');
                    row.className = 'list-row';
                    row.innerHTML = `
                        <span>${menu.menu_id}</span>
                        <div>${imgTag}</div>
                        <span style="text-align:left; font-weight:500;">${menu.menu_name}</span>
                        
                        <!-- üëáüëáüëá 3. ‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ catName ‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÅ‡∏ó‡∏ô üëáüëáüëá -->
                        <span>${catName}</span>
                        
                        <span style="font-weight:bold; color:#2563eb;">${parseFloat(menu.price).toFixed(0)} ‡∏ø</span>
                        <span class="${statusClass}">${statusText}</span>
                        <span class="delete-btn" onclick="deleteMenu(${menu.menu_id})">‚ùå</span>
                    `;
                    listArea.appendChild(row);
                });
            })
            .catch(error => { /* ... */ });
    }

    // --- 3. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π (Fetch POST) ---
    document.getElementById('add-menu-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const formData = new FormData(this);

        fetch(API_URL, { // ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ API_URL
            method: 'POST',
            body: formData 
        })
        .then(response => response.json())
        .then(result => {
            if (result.status === 'success') {
                alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
                this.reset(); 
                showPage('menu-list-page', document.getElementById('btn-list'));
            } else {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + result.message);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ');
        });
    });

    // --- 4. ‡∏•‡∏ö‡πÄ‡∏°‡∏ô‡∏π (Fetch DELETE action) ---
    function deleteMenu(id) {
        if(confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÄ‡∏°‡∏ô‡∏π ID: ' + id + ' ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
            // ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ API_URL ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤ action=delete
            fetch(`${API_URL}?action=delete&id=${id}`)
                .then(res => res.json())
                .then(result => {
                    if(result.status === 'success') {
                        loadMenus(); 
                    } else {
                        alert('‡∏•‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + result.message);
                    }
                })
                .catch(err => console.error(err));
        }
    }

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
    document.addEventListener('DOMContentLoaded', () => {
        loadMenus();
    });
</script>

</body>
</html>